\chapter{Cenários de Decisões}
\label{cap-scenery}

Neste capítulo será apresentado o conceito de Cenários de Decisões, que visa contemplar um dos objetivos principais da presente monografia: Definição de cenários a partir de estudos teóricos para melhorar a interpretação e tomada de decisão sobre métricas estáticas de código-fonte. No Capítulo (REFERENCIAR CHAPTER) foi apresentada a importância do \emph{design} de software. Além disso, discutimos o papel do Engenheiro de Software no desenvolvimento de códigos com \emph{design} robusto, limpo e seguro, explorando os principais conceitos, problemas, princípios e práticas que este profissional deve conhecer para alcançar este objetivo. 

%

Na seção (CITAR SEÇÂO) do Capítulo (REFERENCIAR CHAPTER) ainda foram introduzidos temas relacionados ao monitoramento de código-fonte, métricas de design de software e métricas de vulnerabilidades. Aferimos que apesar de vários estudos relacionados à utilização de métricas de código-fonte ainda existem muitas dificuldades da adoção prática de métricas de código-fonte em projetos reais de Software. Deve-se enfatizar que métricas não resolvem problemas e sim as pessoas \cite{westfall2005}. Métricas de software atuam como indicadores para prover informação, entendimento, avaliação, controle e predição para que as pessoas possam fazer escolhas e ações. Neste sentido, no presente capítulo buscamos reduzir a distância entre a medição do código-fonte e tomada de decisões por Engenheiros de Software através da proposta de Cenários de Decisões.

%

Cenários de Decisões nomeiam e mapeiam estados observáveis através de métricas de código-fonte que indicam a existência de determinada característica dentro do software, classe ou método. Um Cenário de Decisão é composto por:

%

\begin{itemize}
\item \textbf{Nome}: Identificação única do cenário. Deve ser significativo para prover a compreensão do estado que o cenário representa.
\item \textbf{Métricas Envolvidas}: Identifica as métricas necessárias para a caracterização do cenário, sem definir relações entre essas métricas.
\item \textbf{Descrição}: Discuti os problemas, princípios envolvidos e a caracterização
\item \textbf{Caracterização com Métricas}: Define e discuti como as métricas envolvidas devem ser utilizadas para identificar o cenário. Pode definir a composição destas métricas ou a interpretação conjunta necessária.
\item \textbf{Ações sugeridas}: Propõe um conjunto de ações específicas tais como uma refatoração, a utilização de um padrão de projeto, prática e aplicação de princípios.
\end{itemize}

%

O objetivo da definição de Cenários é minimizar as principais dificuldades existentes na medição do código-fonte:

%

\begin{itemize}
\item \textbf{Escolha de Métricas}: Cada cenário é composto por um conjunto de métricas que devem ser utilizadas para aferir a ocorrência do mesmo. Neste sentido, caso se queira observar se um software possui um determinado cenário de vulnerabilidade específica, por exemplo, o Engenheiro de Software ou Gerente devem se preocupar apenas sobre a escolha correta do cenário, abstraindo a escolha de métricas específicas.
\item \textbf{Interpretação de Valores}: A ocorrência de um cenário em algum trecho específico do código deve ser, por si só, o suficiente para o entendimento e avaliação do estado de \emph{design} deste trecho, não havendo a necessidade de ter que se interpretar os valores obtidos. A existência de um cenário ruim específico em um  método deve prover o entendimento necessário para que o Engenheiro de Software realize ações para remoção deste cenário.
\item \textbf{Redundância de Métricas}: Existem muitas métricas na Engenharia de Software que podem ser utilizadas para medir a mesma característica do software tais como tamanho, complexidade e coesão. Compreender cada uma delas e suas intersecções é uma tarefa dispendiosa, dificultando a escolha adequada de métricas que avaliem bem os elementos do software sem redundância de informação. A redundância de métricas não é algo desejado em projetos de software uma vez que a medição é um processo complexo e caro. Cenários idealmente devem ser estabelecidos a partir de estudos e experimentos. Assim, métricas consideradas redundantes podem ser eliminadas a partir da definição de cenários ou podem ser necessárias para a identificação de cenários diferentes para os quais essas métricas agregam alguma informação.
\item \textbf{Interpretações Isoladas}: Podem existir métricas que possam ser utilizadas para a identificação de um cenário específico sem a necessidade de uso de outras métricas. Entretanto, na maioria dos casos uma métrica não provê informação suficiente a ponto de poder ser interpretada isoladamente. Assim, Cenários de Decisões diminuem o risco de interpretações isoladas inadequadas, pois reunem um conjunto de métricas necessários para sua caracterização. Mesmo quando um cenário é composto por uma métrica específica, ele oferece um nível de abstração e interpretação que diminui as possibilidades de erros de interpretação.
\item \textbf{Parâmetros de Comparação}: Os cenários definem uma interpretação a partir de um conjunto de métricas, mas não especificando valores de intervalos necessários para caracterizar este cenário. Assim, um cenário deve ser adaptável para diferentes contextos devido a importância de se flexibilizar as interpretações de métricas, tema discutido e defendido por Meirelles (\citeyear{meirelles2013metrics}). Sugere-se que a escolha dos parâmetros adequados para caracterização do cenário deve ser feita por especialistas que compreendam as necessidades de seus projetos e as limitações e recursos da linguagem e paradigma de programação utilizados no software. Portanto, a escolha dos valores para caracterização de um cenário é a instanciação deste cenário para um contexto específico. Nesta monografia, além da proposta de cenários, também iremos propor instâncias destes cenários para determinados contextos.
\end{itemize}

%

Com os Cenários de Decisões introduzimos um novo conceito a ser utilizado na medição de software. Espera-se que o esforço destinado a medição de software em um projeto seja concentrado sobre a instanciação destes cenários, diminuindo-se o esforço necessário para coleta, interpretação e viusalização de dados. Entretanto, os benefícios dos Cenários de Decisões são passíveis de experimentação, experimentos esses que estão fora do escopo deste trabalho.

%

Cenários de Decisões podem ser classificados de três formas diferentes baseados nas diferentes formas de utilização de métricas para a caracterização do mesmo:

\begin{itemize}
\item \textbf{Monométrico\footnote{Monométrico: de uma só medida}}: Classificação de cenário que pode ser caracterizado por apenas uma métrica, não havendo a necessidade de observação de outras variáveis para que o cenário seja identificado.
\item \textbf{Polimétrico\footnote{Polimétrico: que apresenta ou emprega uma variedade de medidas}}: Classificação de cenário que precisa da interpretação de duas ou mais métricas para ser caracterizado. Cenários polimétricos são menos acoplados a escolha de métricas uma vez que sua identificação depende de mais de uma métrica, podendo ser uma caracterização mais completa de um cenário monométrico. 
\item \textbf{Composto\footnote{Composto: formado de diversas partes}}: Classificação de cenário que é caracterizado a partir de uma métrica composta por outras métricas a partir de fórmulas matemáticas.
\end{itemize}

%

%http://estudijas.lu.lv/pluginfile.php/317090/mod_resource/content/1/metrics_traps_to_avoid.pdf
%http://swerl.tudelft.nl/twiki/pub/Main/TechnicalReports/TUD-SERG-2013-003.pdf
%http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.384.7471

%------------------------------------------------------------------------------%

\section{Definição de Cenários de Decisão para Vulnerabilidades de Software}

A revisão teórica feita nesta monografia encontrada no capítulo (\ref{cap-metrics}) a respeito de características de bom \emph{design} e vulnerabilidades de software nos permite afirmar que a qualidade do código está diretamente relacionada a vulnerabilidades, visto que um código que possui alta complexidade, baixa modularização, alto acoplamento, entre outras caracteristicas apresentdas na seção (\ref{sec-principles-practises}) são mais fáceis de inserir vulnerabilidades e dificultam a descoberta de vulnerabilidades já existentes. Na seção (\ref{sec-security-principles}) foi visto também que muitos princípios de segurança de software estão relacionados ao \emph{design} do código. Visto isso, a aplicação de boas práticas de \emph{design} de código se torna essencial para o desenvolvimento de softwares seguros.

%

Porém, vulnerabilidades de software não ocorrem somente em códigos com mal \emph{design}. Na seção (\ref{subsec-vulnerabilities-taxonomy}) foi visto que existe uma gama de vulnerabilidades específicas catalogadas pela comunidade, e muitas destas vulnerabilidades foram descobertas e reportadas por grandes empresas de softwares renomados no mercado, que muito provavelmente são bem maduras em relação a qualidade de seus produtos. Foi visto também que muitas das vulnerabilidades de software que são identificadas por ferramentas de análise estática (seção \ref{subsec-security-metrics}) são vulnerabilidaddes específicas de uso de códigos, funções ou práticas consideradas perigosas para segurança da aplicação. Tais vulnerabilidades podem ser encontradas no código fonte indepentente da aplicação de boas práticas de \emph{design}, pois tais vulnerabilidades são difíceis de identificar pois necessitam do conhecimento mais aprofundado do Engenheiro de Software para que este saiba que está inserindo uma vulnerabilidade no código.

%

Dessa forma, para o contexto de vulnerabilidades do software, podemos definir dois tipos de cenários de decisão:

%

\begin{itemize}
\item \textbf{Cenários de Decisão para Caracterização da Qualidade de Código}: Estes cenários buscam identificar caracteristicas de software relacionadas a qualidade e design de código que podem influenciar em sua segurança, como complexidade, acoplamento, etc.
\item \textbf{Cenários de Decisão para Caracterização de Vulnerabilidades espefífica de código}: Estes cenários buscam identificar vulnerabilidades de software que podem ser encontradas em código-fonte indepente que este esteja em um bom nível de qualidade e design. São cenários relacionados mais a erros que podem ser cometidos pelos desenvolvedores no momento da implementação;
\end{itemize}

%

\subsubsection{Cenários de Decisão para Caracterização da Qualidade do Código }

%

\textbf{Alta superfície de ataque}

%

Este cenário busca identifica a violação do princípio de \emph{design} de segurança Redução da Superfície de Ataque (Seção \ref{sec-security-principles}). Este princípio se baseia fundamentalmente na redução da exposição das estruturas do sistema em relação a interações externas. Em termos de \emph{design}, a diminuição de métodos públicos de classes assim como a diminuição do acesso as informações internas da classe podem ser obtidos a partir de um maior grau de encapsulamento das estruturas que compõem esta classe. Além disso, a dependência de parâmetros externos para realização de operações internas pode expor maiores detalhes dos mecanismos e algoritmos das classes de um projeto, sendo resultado do baixo grau de encapsulamento das operações, além de aumentar riscos de ataques e dificuldades de correção de problemas de segurança. 

%

Em termos de métricas de código-fonte, este cenário busca medir a quantidade de interações possíveis com um determinado objeto além de avaliar. Estão inclusos nesse cenário classes ou módulos que tenham um alto valor de quantidade de métodos e atributos públicos e métodos que tenham um elevado número de parâmetros. 

%

Há várias opções de \emph{refactorings} que o Engenheiro de Software pode aplicar durante o desenvolvimento para adequar o encapsulamento de suas classes de acordos com os objetivos de segurança do princípio \emph{reduce attack surface}: \emph{Encapsulate Collection}\footnote{\url{http://refactoring.com/catalog/encapsulateCollection.html}}; \emph{Encapsulate Field}\footnote{\url{http://refactoring.com/catalog/encapsulateField.html}}; \emph{Hide Method}\footnote{\url{http://refactoring.com/catalog/hideMethod.html}}; \emph{Remove Parameter}\footnote{\url{http://refactoring.com/catalog/removeParameter.html}}; \emph{Encapsulate Field}\footnote{\url{http://refactoring.com/catalog/encapsulateField.html}};


Quadro resumo:

\begin{itemize}
\item \textbf{Nome}: Alta Superfície de Ataque
\item \textbf{Métricas Envolvidas}: NPA (Número de Atributos Públicos), NPM(Número de Métodos Públicos), ANPM(Média de Parâmetros por Método);
\item \textbf{Descrição}: Esse cenário busca identificar classes e métodos que possuem muita exposição devido ao alto número de métodos e atributos públicos e número elevado de parâmetros de entrada de métodos, violando o princípio de \emph{design} seguro Redução de Superfície de Ataque.
\item \textbf{Caracterização com Métricas}: NPA alto e distante de zero; NPM consideravelmente alto; ANPM alto;
\item \textbf{Ações sugeridas}: Refatorações aplicáveis: \emph{Encapsulate Collection}\footnote{\url{http://refactoring.com/catalog/encapsulateCollection.html}}; \emph{Encapsulate Field}\footnote{\url{http://refactoring.com/catalog/encapsulateField.html}}; \emph{Hide Method}\footnote{\url{http://refactoring.com/catalog/hideMethod.html}}; \emph{Remove Parameter}\footnote{\url{http://refactoring.com/catalog/removeParameter.html}}; \emph{Encapsulate Field}\footnote{\url{http://refactoring.com/catalog/encapsulateField.html}};
\end{itemize}

%

\subsubsection{Cenários de Decisão para Caracterização de Vulnerabilidades Específicas de Código}

%

\textbf{Parâmetros de entrada de usuário não são verificados}

Este cenário busca identificar situações no código fonte o valor de uma entrada de usuário é passado para uma variável sem que tenha sido feito, antes da atribuição e uso, uma verificação desse dado de entrada. Essa vulnerabilidade é catalogada no padrão CWE como CWE-20\fontenote{\url{http://cwe.mitre.org/data/definitions/20.html}}, que é classificada como uma classe que inclui diversas vulnerabilidades com mais nível de detalhe relacionadas a não validação. A não validação de atributos de entrada de usuário pode implicar em diversos riscos para a aplicação. Com essa vulnerabilidade podem ser exploradas vulnerabilidades  mais específica como \emph{Buffer Overflow}, \emph{SQL injection} e \emph{XSS}, permitindo ao atacante inserir valores inesperados, podendo causar a quebra da aplicação; ler arquivos confidenciais por manipulação do do programa, como por exemplo o uso de \emph{SQL injection}; como também pode modificar dados ou mudar o fluxo de programa explorando o \emph{Buffer Overflow}.

%

Em termos de métricas de código fonte, este cenário busca medir métricas de vulnerabilidade que identificam a ocorrencia da não verificação dos parâmetros de entrada. Então, este cenário busca medir a métria AUV somente, caracterizando este cenário como monométrico. Se a medida desta métrica for maior um, quer dizer que existe ao menos uma ocorrência dessa vulnerabilidade, e já caracteriza a ocorrência deste cenário.

%

Para tratar este cenário deve ser feito uma verificação e tratamento do dado de etrada antes de seu uso para se certificar que a informação está realmente aplicavel ao contexto. Então pode ser interessante a criação de uma lista de valores válidos ou determinação de regras para cada entrada não validada e realizar a verificação, e o tratamento para caso a entrada não esteja adequada.




%------------------------------------------------------------------------------%

